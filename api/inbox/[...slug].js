import { NextRequest } from 'next/server';

export const config = {
  runtime: 'edge',
};

export default async function handler(req: NextRequest) {
  const url = req.nextUrl.pathname;
  const ts = Date.now();

  console.log(`[ðŸ“¥] ${ts}: Incoming request to ${url}`);

  return new Response(
    // 1x1 transparent .ico file to stop browser retries
    new Uint8Array([
      0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x10, 0x10,
      0x00, 0x00, 0x01, 0x00, 0x04, 0x00, 0x28, 0x01,
      0x00, 0x00, 0x16, 0x00, 0x00, 0x00, 0x28, 0x00,
      0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x20, 0x00,
      0x00, 0x00, 0x01, 0x00, 0x04, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    ]),
    {
      status: 200,
      headers: {
        'Content-Type': 'image/x-icon',
        'Cache-Control': 'no-store',
      },
    }
  );
}
